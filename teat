-- Auto Megaphone - MINIMAL (KEIN DEBUG)
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local enabled = true

local function useMegaphone()
	local megaphone = LocalPlayer.Backpack:FindFirstChild("Megaphone") or 
	                  (LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Megaphone"))
	if not megaphone then return end
	
	if megaphone.Parent == LocalPlayer.Backpack then
		local hum = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
		if hum then hum:EquipTool(megaphone) task.wait(0.1) end
	end
	
	megaphone:Activate()
end

local function setup(prompt)
	if prompt.HoldDuration ~= 1.5 then return end
	
	prompt.PromptButtonHoldBegan:Connect(function(plr)
		if plr ~= LocalPlayer or not enabled then return end
		task.delay(1.2, useMegaphone)
	end)
end

task.wait(2)

for _, desc in ipairs(workspace:GetDescendants()) do
	if desc:IsA("ProximityPrompt") then
		setup(desc)
	end
end

workspace.DescendantAdded:Connect(function(desc)
	if desc:IsA("ProximityPrompt") then
		task.wait(0.1)
		setup(desc)
	end
end)

game:GetService("UserInputService").InputBegan:Connect(function(input, gp)
	if gp then return end
	if input.KeyCode == Enum.KeyCode.F7 then
		enabled = not enabled
	end
end)
